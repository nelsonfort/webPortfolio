<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-en="Gauge Test PCB - My Portfolio" data-es="PCB Prueba Medidor - Mi Portafolio">PCB Prueba Medidor - Mi Portafolio</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <div class="container">
            <h1 class="logo-text" data-en="Nelson Fortunatti" data-es="Nelson Fortunatti">Nelson Fortunatti</h1>
            <ul>
                <li><a href="index.html#cover" data-en="Home" data-es="Inicio">Inicio</a></li>
                <li><a href="index.html#about" data-en="About Me" data-es="Sobre Mí">Sobre Mí</a></li>
                <li><a href="index.html#projects" data-en="Projects" data-es="Proyectos">Proyectos</a></li>
                <li><a href="index.html#contact" data-en="Contact" data-es="Contacto">Contacto</a></li>
                <li id="lang-switcher"><a href="#">English</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <section class="project-detail-section">
            <div class="container">
                <h2 data-en="Gauge Test PCB" data-es="PCB Prueba Medidor">PCB Prueba Medidor</h2>

                <div class="carousel-container">
                    <div class="carousel-slides">
                        <div class="carousel-slide" style="background-image: url('images/project6/img1.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project6/img2.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project6/img3.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project6/img4.jpg');"></div>
                        </div>
                </div>

                <div class="project-detail-description">
                    <h3 data-en="About This Project" data-es="Sobre Este Proyecto">Sobre Este Proyecto</h3>
                    <p data-en="This board is used to test the BQ34z100 Gauge IC with two different current sense circuits: one based on a 1mOhm resistor and the second based on a 0.1mOhm resistor with a current sense amplifier. The amplifier increases the measured voltage by 10, simulating a 1mOhm resistor on the SRP and SRN pins of the Gauge IC. The objective is to determine if the measurement with the current sense amplifier is as accurate as expected for use in high-current applications, like the 14s smart battery board designed for up to 150A." data-es="Esta placa se utiliza para probar el CI de medición BQ34z100 con dos circuitos de detección de corriente diferentes: uno basado en una resistencia de 1mOhm y el segundo basado en una resistencia de 0.1mOhm con un amplificador de detección de corriente. El amplificador aumenta el voltaje medido por 10, simulando una resistencia de 1mOhm en los pines SRP y SRN del CI de medición. El objetivo es determinar si la medición con el amplificador de detección de corriente es tan precisa como se espera para su uso en aplicaciones de alta corriente, como la placa de batería inteligente de 14s diseñada para hasta 150A.">This board is used to test the BQ34z100 Gauge IC with two different current sense circuits: one based on a 1mOhm resistor and the second based on a 0.1mOhm resistor with a current sense amplifier. The amplifier increases the measured voltage by 10, simulating a 1mOhm resistor on the SRP and SRN pins of the Gauge IC. The objective is to determine if the measurement with the current sense amplifier is as accurate as expected for use in high-current applications, like the 14s smart battery board designed for up to 150A.</p>
                    <h3 data-en="Key Aspects:" data-es="Aspectos Clave:">Aspectos Clave:</h3>
                    <ul>
                        <li data-en="BQ34z100 Gauge IC Testing" data-es="Prueba del CI de Medición BQ34z100">Prueba del CI de Medición BQ34z100</li>
                        <li data-en="Dual Current Sense Circuits (1mOhm and 0.1mOhm with Amplifier)" data-es="Circuitos de Detección de Corriente Doble (1mOhm y 0.1mOhm con Amplificador)">Circuitos de Detección de Corriente Doble (1mOhm y 0.1mOhm con Amplificador)</li>
                        <li data-en="Accuracy Evaluation for High Current" data-es="Evaluación de Precisión para Alta Corriente">Evaluación de Precisión para Alta Corriente</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p><span data-en="&copy; 2025 Nelson Fortunatti. All rights reserved." data-es="&copy; 2025 Nelson Fortunatti. Todos los derechos reservados.">&copy; 2025 Nelson Fortunatti. Todos los derechos reservados.</span></p>
            <p><span data-en="nelsonfortunatti@gmail.com" data-es="nelsonfortunatti@gmail.com">nelsonfortunatti@gmail.com</span></p>
        </div>
    </footer>

    <div id="imageModal" class="modal">
        <span class="close-modal">&times;</span>
        <a class="prev-modal">&#10094;</a>
        <img class="modal-content" id="modalImage">
        <a class="next-modal">&#10095;</a>
        <div id="caption"></div>
    </div>

    <script>
         document.addEventListener('DOMContentLoaded', () => {
             // --- Language Switcher Script ---
             const htmlTag = document.documentElement;
             const langSwitcherLink = document.getElementById('lang-switcher').querySelector('a');
             const elementsToTranslate = document.querySelectorAll('[data-en], [data-es], [data-en-placeholder], [data-es-placeholder]');
             const titleTag = document.querySelector('title');

             function setLanguage(lang) {
                 htmlTag.lang = lang;
                 localStorage.setItem('lang', lang);

                 if (lang === 'es') {
                     langSwitcherLink.textContent = 'English';
                 } else {
                     langSwitcherLink.textContent = 'Español';
                 }

                 const titleEn = titleTag.getAttribute('data-en');
                 const titleEs = titleTag.getAttribute('data-es');
                 if (lang === 'en' && titleEn) {
                     titleTag.textContent = titleEn;
                 } else if (lang === 'es' && titleEs) {
                     titleTag.textContent = titleEs;
                 }

                 elementsToTranslate.forEach(element => {
                     const textEn = element.getAttribute('data-en');
                     const textEs = element.getAttribute('data-es');
                     if (lang === 'en' && textEn !== null) {
                         element.textContent = textEn;
                     } else if (lang === 'es' && textEs !== null) {
                         element.textContent = textEs;
                     }

                     const placeholderEn = element.getAttribute('data-en-placeholder');
                     const placeholderEs = element.getAttribute('data-es-placeholder');
                     if (lang === 'en' && placeholderEn !== null) {
                          element.placeholder = placeholderEn;
                     } else if (lang === 'es' && placeholderEs !== null) {
                          element.placeholder = placeholderEs;
                     }
                 });
             }

             const savedLang = localStorage.getItem('lang');
             if (savedLang) {
                 setLanguage(savedLang);
             } else {
                  setLanguage(htmlTag.lang || 'es'); // Default to 'es' if not set
             }

             langSwitcherLink.addEventListener('click', (event) => {
                 event.preventDefault();
                 const currentLang = htmlTag.lang;
                 const newLang = currentLang === 'es' ? 'en' : 'es';
                 setLanguage(newLang);
             });

             // --- Carousel Script ---
             const carouselSlidesContainer = document.querySelector('.carousel-slides');
             const slides = document.querySelectorAll('.carousel-slide'); // Re-select for this script's scope
             const intervalTime = 2000; // 2 seconds
             let slideInterval;
             let currentIndex = 0;

             if (carouselSlidesContainer && slides.length > 0) { // Check if elements exist
                 function moveCarouselTo(index) {
                      currentIndex = index;
                      const offset = -currentIndex * 100;
                      carouselSlidesContainer.style.transform = `translateX(${offset}%)`;
                 }

                 function nextSlide() {
                     currentIndex++;
                     if (currentIndex >= slides.length) {
                          currentIndex = 0;
                     }
                     moveCarouselTo(currentIndex);
                 }

                 slideInterval = setInterval(nextSlide, intervalTime);

                 carouselSlidesContainer.parentElement.addEventListener('mouseenter', () => {
                      clearInterval(slideInterval);
                 });

                 carouselSlidesContainer.parentElement.addEventListener('mouseleave', () => {
                      slideInterval = setInterval(nextSlide, intervalTime);
                 });

                  moveCarouselTo(0); // Initialize carousel position
             } else if (slides.length > 0) { // Only slides exist, not container (should not happen with current HTML)
                 console.warn("Carousel slides found, but container .carousel-slides is missing.");
             } else {
                 console.warn("No slides found for the carousel.");
             }

             // --- Image Modal Script ---
            const modal = document.getElementById("imageModal");
            if (modal) {
                modal.style.display = "none";
            }
            const modalImg = document.getElementById("modalImage");
            // Uncommented and selected the new modal buttons
            const prevModalButton = document.querySelector(".prev-modal");
            const nextModalButton = document.querySelector(".next-modal");
            // const captionText = document.getElementById("caption"); // Uncomment if using captions

            let currentModalImageIndex = 0;
            let carouselImageSources = [];

            // Collect all carousel image sources on page load
            // This assumes all .carousel-slide elements are for the main carousel on the page
            const allCarouselSlides = document.querySelectorAll('.carousel-slide');
            allCarouselSlides.forEach(slide => {
                let style = window.getComputedStyle(slide);
                let bgImage = style.getPropertyValue('background-image');
                if (bgImage && bgImage !== 'none') {
                    // Extract URL from background-image style
                    const urlMatch = bgImage.match(/url\(["']?(.*?)["']?\)/);
                    if (urlMatch && urlMatch[1]) {
                        carouselImageSources.push(urlMatch[1]);
                    }
                }
            });

            function showImageInModal(index) {
                if (carouselImageSources.length === 0 || !modalImg) return;
                currentModalImageIndex = index;
                modalImg.src = carouselImageSources[currentModalImageIndex];
                // Example for caption:
                // const currentSlideElement = allCarouselSlides[currentModalImageIndex];
                // if (captionText && currentSlideElement) {
                //     captionText.innerHTML = currentSlideElement.getAttribute('data-caption') || '';
                // }
            }

            allCarouselSlides.forEach((slide, index) => {
                slide.onclick = function(){
                    if (modal && modalImg && carouselImageSources.length > 0) {
                        modal.style.display = "block";
                        showImageInModal(index);
                    }
                }
            });

            // Added click handlers for the new modal buttons
            if (prevModalButton) {
                prevModalButton.onclick = function() {
                    currentModalImageIndex--;
                    if (currentModalImageIndex < 0) {
                        currentModalImageIndex = carouselImageSources.length - 1;
                    }
                    showImageInModal(currentModalImageIndex);
                }
            }

            if (nextModalButton) {
                nextModalButton.onclick = function() {
                    currentModalImageIndex++;
                    if (currentModalImageIndex >= carouselImageSources.length) {
                        currentModalImageIndex = 0;
                    }
                    showImageInModal(currentModalImageIndex);
                }
            }

            const closeModalButton = document.querySelector(".close-modal");
            if (closeModalButton && modal) {
                closeModalButton.onclick = function() {
                    modal.style.display = "none";
                }
            }

            window.onclick = function(event) {
                if (event.target == modal && modal) {
                    modal.style.display = "none";
                }
            }

            // Optional: Add keyboard navigation for arrows when modal is open
            document.addEventListener('keydown', function(event) {
                if (modal && modal.style.display === "block") {
                    if (event.key === "ArrowLeft") {
                        if (prevModalButton) prevModalButton.click();
                    } else if (event.key === "ArrowRight") {
                        if (nextModalButton) nextModalButton.click();
                    } else if (event.key === "Escape") {
                        if (closeModalButton) closeModalButton.click();
                    }
                }
            });
        });
     </script>

</body>
</html>