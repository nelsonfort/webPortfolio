<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-en="Smart Irrigation System - My Portfolio" data-es="Sistema Riego Inteligente - Mi Portafolio">Sistema Riego Inteligente - Mi Portafolio</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <div class="container">
            <h1 class="logo-text" data-en="Nelson Fortunatti" data-es="Nelson Fortunatti">Nelson Fortunatti</h1>
            <button class="nav-toggle" aria-label="toggle navigation" aria-expanded="false">
                <span class="hamburger"></span>
            </button>
            <ul id="primary-navigation">
                <li><a href="index.html#cover" data-en="Home" data-es="Inicio">Inicio</a></li>
                <li><a href="index.html#about" data-en="About Me" data-es="Sobre Mí">Sobre Mí</a></li>
                <li><a href="index.html#projects" data-en="Projects" data-es="Proyectos">Proyectos</a></li>
                <li><a href="index.html#contact" data-en="Contact" data-es="Contacto">Contacto</a></li>
                <li id="lang-switcher"><a href="#">English</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <section class="project-detail-section">
            <div class="container">
                <h2 data-en="Smart Farm Irrigation System" data-es="Sistema de Riego Inteligente para Granjas">Sistema de Riego Inteligente para Granjas</h2>

                <div class="carousel-container">
                    <div class="carousel-slides">
                        <div class="carousel-slide" style="background-image: url('images/project4/img1.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project4/img2.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project4/img3.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project4/img4.jpg');"></div>
                    </div>
                </div>

                <div class="project-detail-description">
                    <h3 data-en="About This Project" data-es="Sobre Este Proyecto">Sobre Este Proyecto</h3>
                    <p data-en="This project, deployed on farms across Australia, delivers a comprehensive IoT-based solution for automating farm irrigation to optimize water usage and crop health. The system supports over 10 families of distributed sensor/actuator nodes, each built around the ESP32 microcontroller. Initially utilizing FreeRTOS within the Arduino framework, the firmware was later ported to ESP-IDF to leverage its advanced features." data-es="Este proyecto, implementado en granjas de Australia, ofrece una solución integral basada en IoT para automatizar el riego agrícola, optimizando el uso del agua y la salud de los cultivos. El sistema soporta más de 10 familias de nodos distribuidos de sensores/actuadores, cada uno construido alrededor del microcontrolador ESP32. Inicialmente utilizando FreeRTOS dentro del framework de Arduino, el firmware fue posteriormente portado a ESP-IDF para aprovechar sus características avanzadas.">This project, deployed on farms across Australia, delivers a comprehensive IoT-based solution for automating farm irrigation to optimize water usage and crop health. The system supports over 10 families of distributed sensor/actuator nodes, each built around the ESP32 microcontroller. Initially utilizing FreeRTOS within the Arduino framework, the firmware was later ported to ESP-IDF to leverage its advanced features.</p>
                    <p data-en="The system features dual connectivity options: LoRaWAN (up to SF12 RX2) for extensive area coverage and Cat-M1 cellular for direct, reliable internet access. For LoRaWAN, data from gateways is processed by a Node-RED server, which translates raw data into MQTT messages before forwarding to an AWS backend. Cat-M1 devices send MQTT data directly to AWS. The AWS backend includes ChirpStack for LoRaWAN network management, Node-RED for data processing, and a custom WebApp for remote monitoring and control." data-es="El sistema cuenta con opciones de conectividad dual: LoRaWAN (hasta SF12 RX2) para una amplia cobertura de área y Cat-M1 celular para acceso a internet directo y fiable. Para LoRaWAN, los datos de los gateways son procesados por un servidor Node-RED, que traduce los datos brutos a mensajes MQTT antes de enviarlos a un backend en AWS. Los dispositivos Cat-M1 envían datos MQTT directamente a AWS. El backend en AWS incluye ChirpStack para la gestión de la red LoRaWAN, Node-RED para el procesamiento de datos y una WebApp personalizada para monitoreo y control remoto.">The system features dual connectivity options: LoRaWAN (up to SF12 RX2) for extensive area coverage and Cat-M1 cellular for direct, reliable internet access. For LoRaWAN, data from gateways is processed by a Node-RED server, which translates raw data into MQTT messages before forwarding to an AWS backend. Cat-M1 devices send MQTT data directly to AWS. The AWS backend includes ChirpStack for LoRaWAN network management, Node-RED for data processing, and a custom WebApp for remote monitoring and control.</p>
                    <p data-en="Motorized gates are controlled to precisely direct water flow based on sensor readings and schedules. Beyond remote control via the WebApp, each device features a comprehensive local user interface, including menus for data display, settings management, and manual operation, ensuring robust functionality even without network connectivity." data-es="Se controlan compuertas motorizadas para dirigir con precisión el flujo de agua basándose en lecturas de sensores y programaciones. Además del control remoto a través de la WebApp, cada dispositivo cuenta con una interfaz de usuario local completa, que incluye menús para visualización de datos, gestión de configuraciones y operación manual, asegurando una funcionalidad robusta incluso sin conectividad de red.">Motorized gates are controlled to precisely direct water flow based on sensor readings and schedules. Beyond remote control via the WebApp, each device features a comprehensive local user interface, including menus for data display, settings management, and manual operation, ensuring robust functionality even without network connectivity.</p>
                    <p data-en="The project's codebase exceeded 60,000 lines, supporting a wide array of device configurations. Initially developed in C using the Arduino framework, the entire software was refactored into C++, fully embracing object-oriented principles like classes, inheritance, and polymorphism to manage the complexity of over 10 distinct device families. This refactoring also integrated FreeRTOS for improved real-time performance." data-es="La base de código del proyecto superó las 60,000 líneas, soportando una amplia gama de configuraciones de dispositivos. Desarrollado inicialmente en C utilizando el framework de Arduino, todo el software fue refactorizado a C++, adoptando plenamente principios orientados a objetos como clases, herencia y polimorfismo para gestionar la complejidad de más de 10 familias de dispositivos distintas. Esta refactorización también integró FreeRTOS para mejorar el rendimiento en tiempo real.">The project's codebase exceeded 60,000 lines, supporting a wide array of device configurations. Initially developed in C using the Arduino framework, the entire software was refactored into C++, fully embracing object-oriented principles like classes, inheritance, and polymorphism to manage the complexity of over 10 distinct device families. This refactoring also integrated FreeRTOS for improved real-time performance.</p>
                    <p data-en="Over 2,000 devices were successfully deployed across Australia and remain operational today, a testament to the system's reliability. After the initial development and porting to ESP-IDF (to access features unavailable in the Arduino core for ESP32), I single-handedly maintained and enhanced the system with new features for a full year." data-es="Más de 2,000 dispositivos fueron desplegados con éxito en Australia y continúan operativos hoy en día, un testimonio de la fiabilidad del sistema. Después del desarrollo inicial y la portabilidad a ESP-IDF (para acceder a características no disponibles en el núcleo de Arduino para ESP32), mantuve y mejoré el sistema con nuevas funcionalidades de forma individual durante un año completo.">Over 2,000 devices were successfully deployed across Australia and remain operational today, a testament to the system's reliability. After the initial development and porting to ESP-IDF (to access features unavailable in the Arduino core for ESP32), I single-handedly maintained and enhanced the system with new features for a full year.</p>
                    
                    <h3 data-en="System Components:" data-es="Componentes del Sistema:">Componentes del Sistema:</h3>
                    <ul>
                        <li data-en="ESP32-based sensor/actuator nodes with FreeRTOS, later ESP-IDF." data-es="Nodos sensor/actuador basados en ESP32 con FreeRTOS, posteriormente ESP-IDF.">ESP32-based sensor/actuator nodes with FreeRTOS, later ESP-IDF.</li>
                        <li data-en="Dual LoRaWAN and Cat-M1 communication modules." data-es="Módulos de comunicación dual LoRaWAN y Cat-M1.">Dual LoRaWAN and Cat-M1 communication modules.</li>
                        <li data-en="MQTT protocol for standardized data interchange." data-es="Protocolo MQTT para intercambio de datos estandarizado.">MQTT protocol for standardized data interchange.</li>
                        <li data-en="AWS backend: ChirpStack, Node-RED, custom WebApp." data-es="Backend en AWS: ChirpStack, Node-RED, WebApp personalizada.">AWS backend: ChirpStack, Node-RED, custom WebApp.</li>
                        <li data-en="Precise motorized gate control for water distribution." data-es="Control preciso de compuertas motorizadas para distribución de agua.">Precise motorized gate control for water distribution.</li>
                        <li data-en="Comprehensive local UI (menus, data, settings) and remote WebApp." data-es="Interfaz de usuario local completa (menús, datos, configuraciones) y WebApp remota.">Comprehensive local UI (menus, data, settings) and remote WebApp.</li>
                        <li data-en="Support for 10+ device families with extensive configurations." data-es="Soporte para más de 10 familias de dispositivos con amplias configuraciones.">Support for 10+ device families with extensive configurations.</li>
                        <li data-en="Large-scale C++ codebase (>60,000 lines) using OOP principles." data-es="Extensa base de código C++ (>60,000 líneas) utilizando principios de POO.">Large-scale C++ codebase (>60,000 lines) using OOP principles.</li>
                        <li data-en="Deployed and operational in over 2,000 units in Australia." data-es="Desplegado y operativo en más de 2,000 unidades en Australia.">Deployed and operational in over 2,000 units in Australia.</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p><span data-en="© 2025 Nelson Fortunatti. All rights reserved." data-es="© 2025 Nelson Fortunatti. Todos los derechos reservados.">© 2025 Nelson Fortunatti. Todos los derechos reservados.</span></p>
            <p><span data-en="nelsonfortunatti@gmail.com" data-es="nelsonfortunatti@gmail.com">nelsonfortunatti@gmail.com</span></p>
        </div>
    </footer>

    <div id="imageModal" class="modal">
        <span class="close-modal">×</span>
        <a class="prev-modal">❮</a>
        <img class="modal-content" id="modalImage">
        <a class="next-modal">❯</a>
        <div id="caption"></div>
    </div>
    <script>
         document.addEventListener('DOMContentLoaded', () => {
            // --- Hamburger Navigation Toggle ---
            const navToggle = document.querySelector('.nav-toggle');
            const primaryNav = document.getElementById('primary-navigation');

            if (navToggle && primaryNav) {
                navToggle.addEventListener('click', () => {
                    primaryNav.classList.toggle('nav-ul-active');
                    navToggle.classList.toggle('is-active');

                    // ARIA attribute for accessibility
                    const isExpanded = primaryNav.classList.contains('nav-ul-active');
                    navToggle.setAttribute('aria-expanded', isExpanded);
                });

                // Optional: Close menu when a navigation link is clicked (useful for single-page anchors)
                const navLinks = primaryNav.querySelectorAll('a');
                navLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        // Check if the menu is open (especially relevant for mobile)
                        if (window.innerWidth <= 768 && primaryNav.classList.contains('nav-ul-active')) {
                            primaryNav.classList.remove('nav-ul-active');
                            navToggle.classList.remove('is-active');
                            navToggle.setAttribute('aria-expanded', 'false');
                        }
                    });
                });
            }

            // --- Language Switcher Script ---
            const htmlTag = document.documentElement;
            const langSwitcherListItem = document.getElementById('lang-switcher'); // Get the LI
            let langSwitcherLink = null;
            if (langSwitcherListItem) {
                langSwitcherLink = langSwitcherListItem.querySelector('a'); // Get the A inside LI
            }
            const elementsToTranslate = document.querySelectorAll('[data-en], [data-es], [data-en-placeholder], [data-es-placeholder]');
            const titleTag = document.querySelector('title');

            function setLanguage(lang) {
                htmlTag.lang = lang;
                localStorage.setItem('lang', lang);

                if (langSwitcherLink) { // Check if link exists
                    if (lang === 'es') {
                        langSwitcherLink.textContent = 'English';
                    } else {
                        langSwitcherLink.textContent = 'Español';
                    }
                }

                if (titleTag) { // Check if titleTag exists
                    const titleEn = titleTag.getAttribute('data-en');
                    const titleEs = titleTag.getAttribute('data-es');
                    if (lang === 'en' && titleEn) {
                        titleTag.textContent = titleEn;
                    } else if (lang === 'es' && titleEs) {
                        titleTag.textContent = titleEs;
                    }
                }


                elementsToTranslate.forEach(element => {
                    const textEn = element.getAttribute('data-en');
                    const textEs = element.getAttribute('data-es');
                    if (lang === 'en' && textEn !== null) {
                        element.textContent = textEn;
                    } else if (lang === 'es' && textEs !== null) {
                        element.textContent = textEs;
                    }

                    const placeholderEn = element.getAttribute('data-en-placeholder');
                    const placeholderEs = element.getAttribute('data-es-placeholder');
                    if (lang === 'en' && placeholderEn !== null) {
                        element.placeholder = placeholderEn;
                    } else if (lang === 'es' && placeholderEs !== null) {
                        element.placeholder = placeholderEs;
                    }
                });
            }

            const savedLang = localStorage.getItem('lang');
            if (savedLang) {
                setLanguage(savedLang);
            } else {
                setLanguage(htmlTag.lang || 'es'); // Default to 'es' if not set, or to HTML lang attr
            }

            if (langSwitcherLink) { // Check if link exists
                langSwitcherLink.addEventListener('click', (event) => {
                    event.preventDefault();
                    const currentLang = htmlTag.lang;
                    const newLang = currentLang === 'es' ? 'en' : 'es';
                    setLanguage(newLang);
                });
            }

            // --- Carousel Script (Only runs if carousel elements are present) ---
            const carouselSlidesContainer = document.querySelector('.carousel-slides');
            if (carouselSlidesContainer) {
                const slides = document.querySelectorAll('.carousel-slide');
                const intervalTime = 3000;
                let slideInterval;
                let currentIndex = 0;

                if (slides.length > 0) {
                    function moveCarouselTo(index) {
                        currentIndex = index;
                        const offset = -currentIndex * 100;
                        carouselSlidesContainer.style.transform = `translateX(${offset}%)`;
                    }

                    function nextSlide() {
                        currentIndex++;
                        if (currentIndex >= slides.length) {
                            currentIndex = 0;
                        }
                        moveCarouselTo(currentIndex);
                    }

                    slideInterval = setInterval(nextSlide, intervalTime);

                    const carouselContainer = carouselSlidesContainer.parentElement;
                    if (carouselContainer) {
                        carouselContainer.addEventListener('mouseenter', () => {
                            clearInterval(slideInterval);
                        });

                        carouselContainer.addEventListener('mouseleave', () => {
                            slideInterval = setInterval(nextSlide, intervalTime);
                        });
                    }
                    moveCarouselTo(0); // Initialize carousel position
                }
            }

            // --- Image Modal Script (Only runs if modal elements are present) ---
            const modal = document.getElementById("imageModal");
            if (modal) {
                modal.style.display = "none"; // Ensure it's hidden initially
                const modalImg = document.getElementById("modalImage");
                const prevModalButton = document.querySelector(".prev-modal");
                const nextModalButton = document.querySelector(".next-modal");
                // const captionText = document.getElementById("caption"); // Uncomment if you implement captions

                let currentModalImageIndex = 0;
                let carouselImageSources = [];

                // Collect image sources from carousel slides if they exist
                const allCarouselSlidesForModal = document.querySelectorAll('.carousel-slide');
                allCarouselSlidesForModal.forEach(slide => {
                    let style = window.getComputedStyle(slide);
                    let bgImage = style.getPropertyValue('background-image');
                    if (bgImage && bgImage !== 'none') {
                        const urlMatch = bgImage.match(/url\(["']?(.*?)["']?\)/);
                        if (urlMatch && urlMatch[1]) {
                            carouselImageSources.push(urlMatch[1]);
                        }
                    }
                });

                function showImageInModal(index) {
                    if (carouselImageSources.length === 0 || !modalImg) return;

                    currentModalImageIndex = index;
                    // Loop around if index goes out of bounds
                    if (currentModalImageIndex < 0) {
                        currentModalImageIndex = carouselImageSources.length - 1;
                    } else if (currentModalImageIndex >= carouselImageSources.length) {
                        currentModalImageIndex = 0;
                    }
                    modalImg.src = carouselImageSources[currentModalImageIndex];
                    // if (captionText) { captionText.innerHTML = allCarouselSlidesForModal[currentModalImageIndex].getAttribute('data-caption') || ''; }
                }

                allCarouselSlidesForModal.forEach((slide, index) => {
                    slide.onclick = function(){
                        if (modalImg && carouselImageSources.length > 0) {
                            modal.style.display = "flex"; // Use flex for centering
                            showImageInModal(index);
                        }
                    }
                });

                if (prevModalButton) {
                    prevModalButton.onclick = function() { showImageInModal(currentModalImageIndex - 1); }
                }
                if (nextModalButton) {
                    nextModalButton.onclick = function() { showImageInModal(currentModalImageIndex + 1); }
                }

                const closeModalButton = document.querySelector(".close-modal");
                if (closeModalButton) {
                    closeModalButton.onclick = function() { modal.style.display = "none"; }
                }

                window.onclick = function(event) {
                    if (event.target == modal) { modal.style.display = "none"; }
                }

                document.addEventListener('keydown', function(event) {
                    if (modal.style.display === "flex") { // Check if modal is active
                        if (event.key === "ArrowLeft" && prevModalButton) prevModalButton.click();
                        else if (event.key === "ArrowRight" && nextModalButton) nextModalButton.click();
                        else if (event.key === "Escape" && closeModalButton) closeModalButton.click();
                    }
                });
            }
        });
     </script>

</body>
</html>