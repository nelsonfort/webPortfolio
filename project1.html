<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-en="Smart Battery Dev Board - My Portfolio" data-es="Placa Desarrollo Batería - Mi Portafolio">Placa Desarrollo Batería - Mi Portafolio</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <div class="container">
            <h1 class="logo-text" data-en="Nelson Fortunatti" data-es="Nelson Fortunatti">Nelson Fortunatti</h1>
            <button class="nav-toggle" aria-label="toggle navigation" aria-expanded="false">
                <span class="hamburger"></span>
            </button>
            <ul id="primary-navigation">
                <li><a href="index.html#cover" data-en="Home" data-es="Inicio">Inicio</a></li>
                <li><a href="index.html#about" data-en="About Me" data-es="Sobre Mí">Sobre Mí</a></li>
                <li><a href="index.html#projects" data-en="Projects" data-es="Proyectos">Proyectos</a></li>
                <li><a href="index.html#contact" data-en="Contact" data-es="Contacto">Contacto</a></li>
                <li id="lang-switcher"><a href="#">English</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <section class="project-detail-section">
            <div class="container">
                <h2 data-en="Smart Battery Dev Board (6s)" data-es="Placa de Desarrollo para Batería Inteligente (6s)">Placa de Desarrollo para Batería Inteligente (6s)</h2>

                <div class="carousel-container">
                    <div class="carousel-slides">
                        <div class="carousel-slide" style="background-image: url('images/project1/img1.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project1/img2.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project1/img3.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project1/img4.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project1/img5.jpg');"></div>
                    </div>
                </div>

                <div class="project-detail-description">
                    <h3 data-en="About This Project" data-es="Sobre Este Proyecto">Sobre Este Proyecto</h3>
                    <p data-en="This development board was a crucial step in designing a robust 6s Li-Ion/LiPo smart battery system. Its primary purpose was to allow for rigorous testing of key components, particularly MOSFETs and shunt resistors, under significant current loads up to 50A. This helped validate thermal performance and component selection before moving to a compact PCB design." data-es="Esta placa de desarrollo fue un paso crucial en el diseño de un robusto sistema de batería inteligente 6s Li-Ion/LiPo. Su propósito principal fue permitir pruebas rigurosas de componentes clave, particularmente MOSFETs y resistencias shunt, bajo cargas de corriente significativas de hasta 50A. Esto ayudó a validar el rendimiento térmico y la selección de componentes antes de pasar a un diseño de PCB compacto.">Esta placa de desarrollo fue un paso crucial en el diseño de un robusto sistema de batería inteligente 6s Li-Ion/LiPo. Su propósito principal fue permitir pruebas rigurosas de componentes clave, particularmente MOSFETs y resistencias shunt, bajo cargas de corriente significativas de hasta 50A. Esto ayudó a validar el rendimiento térmico y la selección de componentes antes de pasar a un diseño de PCB compacto.</p>
                    <p data-en="Furthermore, the board facilitated the integration and configuration of the battery gauge IC, based on the Texas Instruments BQ40z80. This involved setting up crucial parameters for accurate state-of-charge (SOC) and state-of-health (SOH) monitoring. We also integrated and tested a secondary hardware protection circuit, including a triggerable fuse, enhancing safety measures controlled by both the gauge and a dedicated protector IC." data-es="Además, la placa facilitó la integración y configuración del CI de medición de batería, basado en el BQ40z80 de Texas Instruments. Esto implicó la configuración de parámetros cruciales para un monitoreo preciso del estado de carga (SOC) y estado de salud (SOH). También integramos y probamos un circuito de protección de hardware secundario, incluyendo un fusible disparable, mejorando las medidas de seguridad controladas tanto por el medidor como por un CI protector dedicado.">Furthermore, the board facilitated the integration and configuration of the battery gauge IC, based on the Texas Instruments BQ40z80. This involved setting up crucial parameters for accurate state-of-charge (SOC) and state-of-health (SOH) monitoring. We also integrated and tested a secondary hardware protection circuit, including a triggerable fuse, enhancing safety measures controlled by both the gauge and a dedicated protector IC.</p>
                    <h3 data-en="Key Learnings:" data-es="Aprendizajes Clave:">Aprendizajes Clave:</h3>
                    <ul>
                        <li data-en="Validated thermal performance of power stage components under high load." data-es="Validación del rendimiento térmico de los componentes de la etapa de potencia bajo alta carga.">Validación del rendimiento térmico de los componentes de la etapa de potencia bajo alta carga.</li>
                        <li data-en="Successful integration and configuration of the BQ40z80 gauge IC." data-es="Integración y configuración exitosa del CI de medición BQ40z80.">Integración y configuración exitosa del CI de medición BQ40z80.</li>
                        <li data-en="Demonstrated the effectiveness of the secondary triggerable fuse protection." data-es="Demostración de la efectividad de la protección secundaria con fusible disparable.">Demostración de la efectividad de la protección secundaria con fusible disparable.</li>
                    </ul>
                    </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p><span data-en="&copy; 2025 Nelson Fortunatti. All rights reserved." data-es="&copy; 2025 Nelson Fortunatti. Todos los derechos reservados.">&copy; 2025 Nelson Fortunatti. Todos los derechos reservados.</span></p>
            <p><span data-en="nelsonfortunatti@gmail.com" data-es="nelsonfortunatti@gmail.com">nelsonfortunatti@gmail.com</span></p>
        </div>
    </footer>

    <div id="imageModal" class="modal">
        <span class="close-modal">&times;</span>
        <a class="prev-modal">&#10094;</a>
        <img class="modal-content" id="modalImage">
        <a class="next-modal">&#10095;</a>
        <div id="caption"></div>
    </div>

    <script>
         document.addEventListener('DOMContentLoaded', () => {
            // --- Hamburger Navigation Toggle ---
            const navToggle = document.querySelector('.nav-toggle');
            const primaryNav = document.getElementById('primary-navigation');

            if (navToggle && primaryNav) {
                navToggle.addEventListener('click', () => {
                    primaryNav.classList.toggle('nav-ul-active');
                    navToggle.classList.toggle('is-active');

                    // ARIA attribute for accessibility
                    const isExpanded = primaryNav.classList.contains('nav-ul-active');
                    navToggle.setAttribute('aria-expanded', isExpanded);
                });

                // Optional: Close menu when a navigation link is clicked (useful for single-page anchors)
                const navLinks = primaryNav.querySelectorAll('a');
                navLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        // Check if the menu is open (especially relevant for mobile)
                        if (window.innerWidth <= 768 && primaryNav.classList.contains('nav-ul-active')) {
                            primaryNav.classList.remove('nav-ul-active');
                            navToggle.classList.remove('is-active');
                            navToggle.setAttribute('aria-expanded', 'false');
                        }
                    });
                });
            }

            // --- Language Switcher Script ---
            const htmlTag = document.documentElement;
            const langSwitcherListItem = document.getElementById('lang-switcher'); // Get the LI
            let langSwitcherLink = null;
            if (langSwitcherListItem) {
                langSwitcherLink = langSwitcherListItem.querySelector('a'); // Get the A inside LI
            }
            const elementsToTranslate = document.querySelectorAll('[data-en], [data-es], [data-en-placeholder], [data-es-placeholder]');
            const titleTag = document.querySelector('title');

            function setLanguage(lang) {
                htmlTag.lang = lang;
                localStorage.setItem('lang', lang);

                if (langSwitcherLink) { // Check if link exists
                    if (lang === 'es') {
                        langSwitcherLink.textContent = 'English';
                    } else {
                        langSwitcherLink.textContent = 'Español';
                    }
                }

                if (titleTag) { // Check if titleTag exists
                    const titleEn = titleTag.getAttribute('data-en');
                    const titleEs = titleTag.getAttribute('data-es');
                    if (lang === 'en' && titleEn) {
                        titleTag.textContent = titleEn;
                    } else if (lang === 'es' && titleEs) {
                        titleTag.textContent = titleEs;
                    }
                }


                elementsToTranslate.forEach(element => {
                    const textEn = element.getAttribute('data-en');
                    const textEs = element.getAttribute('data-es');
                    if (lang === 'en' && textEn !== null) {
                        element.textContent = textEn;
                    } else if (lang === 'es' && textEs !== null) {
                        element.textContent = textEs;
                    }

                    const placeholderEn = element.getAttribute('data-en-placeholder');
                    const placeholderEs = element.getAttribute('data-es-placeholder');
                    if (lang === 'en' && placeholderEn !== null) {
                        element.placeholder = placeholderEn;
                    } else if (lang === 'es' && placeholderEs !== null) {
                        element.placeholder = placeholderEs;
                    }
                });
            }

            const savedLang = localStorage.getItem('lang');
            if (savedLang) {
                setLanguage(savedLang);
            } else {
                setLanguage(htmlTag.lang || 'es'); // Default to 'es' if not set, or to HTML lang attr
            }

            if (langSwitcherLink) { // Check if link exists
                langSwitcherLink.addEventListener('click', (event) => {
                    event.preventDefault();
                    const currentLang = htmlTag.lang;
                    const newLang = currentLang === 'es' ? 'en' : 'es';
                    setLanguage(newLang);
                });
            }

            // --- Carousel Script (Only runs if carousel elements are present) ---
            const carouselSlidesContainer = document.querySelector('.carousel-slides');
            if (carouselSlidesContainer) {
                const slides = document.querySelectorAll('.carousel-slide');
                const intervalTime = 3000;
                let slideInterval;
                let currentIndex = 0;

                if (slides.length > 0) {
                    function moveCarouselTo(index) {
                        currentIndex = index;
                        const offset = -currentIndex * 100;
                        carouselSlidesContainer.style.transform = `translateX(${offset}%)`;
                    }

                    function nextSlide() {
                        currentIndex++;
                        if (currentIndex >= slides.length) {
                            currentIndex = 0;
                        }
                        moveCarouselTo(currentIndex);
                    }

                    slideInterval = setInterval(nextSlide, intervalTime);

                    const carouselContainer = carouselSlidesContainer.parentElement;
                    if (carouselContainer) {
                        carouselContainer.addEventListener('mouseenter', () => {
                            clearInterval(slideInterval);
                        });

                        carouselContainer.addEventListener('mouseleave', () => {
                            slideInterval = setInterval(nextSlide, intervalTime);
                        });
                    }
                    moveCarouselTo(0); // Initialize carousel position
                }
            }

            // --- Image Modal Script (Only runs if modal elements are present) ---
            const modal = document.getElementById("imageModal");
            if (modal) {
                modal.style.display = "none"; // Ensure it's hidden initially
                const modalImg = document.getElementById("modalImage");
                const prevModalButton = document.querySelector(".prev-modal");
                const nextModalButton = document.querySelector(".next-modal");
                // const captionText = document.getElementById("caption"); // Uncomment if you implement captions

                let currentModalImageIndex = 0;
                let carouselImageSources = [];

                // Collect image sources from carousel slides if they exist
                const allCarouselSlidesForModal = document.querySelectorAll('.carousel-slide');
                allCarouselSlidesForModal.forEach(slide => {
                    let style = window.getComputedStyle(slide);
                    let bgImage = style.getPropertyValue('background-image');
                    if (bgImage && bgImage !== 'none') {
                        const urlMatch = bgImage.match(/url\(["']?(.*?)["']?\)/);
                        if (urlMatch && urlMatch[1]) {
                            carouselImageSources.push(urlMatch[1]);
                        }
                    }
                });

                function showImageInModal(index) {
                    if (carouselImageSources.length === 0 || !modalImg) return;

                    currentModalImageIndex = index;
                    // Loop around if index goes out of bounds
                    if (currentModalImageIndex < 0) {
                        currentModalImageIndex = carouselImageSources.length - 1;
                    } else if (currentModalImageIndex >= carouselImageSources.length) {
                        currentModalImageIndex = 0;
                    }
                    modalImg.src = carouselImageSources[currentModalImageIndex];
                    // if (captionText) { captionText.innerHTML = allCarouselSlidesForModal[currentModalImageIndex].getAttribute('data-caption') || ''; }
                }

                allCarouselSlidesForModal.forEach((slide, index) => {
                    slide.onclick = function(){
                        if (modalImg && carouselImageSources.length > 0) {
                            modal.style.display = "flex"; // Use flex for centering
                            showImageInModal(index);
                        }
                    }
                });

                if (prevModalButton) {
                    prevModalButton.onclick = function() { showImageInModal(currentModalImageIndex - 1); }
                }
                if (nextModalButton) {
                    nextModalButton.onclick = function() { showImageInModal(currentModalImageIndex + 1); }
                }

                const closeModalButton = document.querySelector(".close-modal");
                if (closeModalButton) {
                    closeModalButton.onclick = function() { modal.style.display = "none"; }
                }

                window.onclick = function(event) {
                    if (event.target == modal) { modal.style.display = "none"; }
                }

                document.addEventListener('keydown', function(event) {
                    if (modal.style.display === "flex") { // Check if modal is active
                        if (event.key === "ArrowLeft" && prevModalButton) prevModalButton.click();
                        else if (event.key === "ArrowRight" && nextModalButton) nextModalButton.click();
                        else if (event.key === "Escape" && closeModalButton) closeModalButton.click();
                    }
                });
            }
        });
     </script>

</body>
</html>