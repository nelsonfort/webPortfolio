<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-en="High Power Battery PCB - My Portfolio" data-es="PCB Batería Alta Potencia - Mi Portafolio">PCB Batería Alta Potencia - Mi Portafolio</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <div class="container">
            <h1 class="logo-text" data-en="Nelson Fortunatti" data-es="Nelson Fortunatti">Nelson Fortunatti</h1>
            <button class="nav-toggle" aria-label="toggle navigation" aria-expanded="false">
                <span class="hamburger"></span>
            </button>
            <ul id="primary-navigation">
                <li><a href="index.html#cover" data-en="Home" data-es="Inicio">Inicio</a></li>
                <li><a href="index.html#about" data-en="About Me" data-es="Sobre Mí">Sobre Mí</a></li>
                <li><a href="index.html#projects" data-en="Projects" data-es="Proyectos">Proyectos</a></li>
                <li><a href="index.html#contact" data-en="Contact" data-es="Contacto">Contacto</a></li>
                <li id="lang-switcher"><a href="#">English</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <section class="project-detail-section">
            <div class="container">
                <h2 data-en="High Power Smart Battery PCB (14-16s)" data-es="PCB para Batería Inteligente de Alta Potencia (14-16s)">PCB para Batería Inteligente de Alta Potencia (14-16s)</h2>

                <div class="carousel-container">
                    <div class="carousel-slides">
                        <div class="carousel-slide" style="background-image: url('images/project3/img1.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project3/img2.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project3/img3.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project3/img4.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project3/img5.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project3/img6.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project3/img7.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project3/img8.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project3/img9.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project3/img10.jpg');"></div>
                        <div class="carousel-slide" style="background-image: url('images/project3/img11.jpg');"></div>
                    </div>
                </div>

                <div class="project-detail-description">
                    <h3 data-en="About This Project" data-es="Sobre Este Proyecto">Sobre Este Proyecto</h3>
                    <p data-en="Designed for demanding applications like scientific or military drones, this high-power smart battery PCB supports 14s to 16s configurations and is engineered to handle substantial currents up to 150A continuously without a heatsink. This capability is achieved through a meticulously designed 6-layer PCB with 2 Oz copper thickness on all layers and a power stage featuring 5 back-to-back MOSFETs in parallel for both charging and discharging paths." data-es="Diseñada para aplicaciones exigentes como drones científicos o militares, esta PCB de batería inteligente de alta potencia soporta configuraciones de 14s a 16s y está diseñada para manejar corrientes sustanciales de hasta 150A continuamente sin disipador. Esta capacidad se logra a través de una PCB de 6 capas meticulosamente diseñada con un grosor de cobre de 2 Oz en todas las capas y una etapa de potencia que presenta 5 MOSFETs 'back-to-back' en paralelo para las rutas de carga y descarga.">Diseñada para aplicaciones exigentes como drones científicos o militares, esta PCB de batería inteligente de alta potencia soporta configuraciones de 14s a 16s y está diseñada para manejar corrientes sustanciales de hasta 150A continuamente sin disipador. Esta capacidad se logra a través de una PCB de 6 capas meticulosamente diseñada con un grosor de cobre de 2 Oz en todas las capas y una etapa de potencia que presenta 5 MOSFETs 'back-to-back' en paralelo para las rutas de carga y descarga.</p>
                    <p data-en="The board integrates the BQ34z100 gauge IC for accurate fuel gauging, the BQ76952 for battery monitoring, and the BQ77216 for robust battery protection, ensuring safe operation under extreme conditions. Communication with the host system (the drone) is handled via a reliable DroneCan interface. A key design principle was scalability, allowing for the creation of a family of products with varying current capacities by simply adjusting the type and quantity of MOSFETs used." data-es="La placa integra el CI de medición BQ34z100 para una medición precisa de la carga, el BQ76952 para el monitoreo de la batería y el BQ77216 para una protección robusta de la batería, asegurando una operación segura bajo condiciones extremas. La comunicación con el sistema anfitrión (el drone) se maneja a través de una interfaz DroneCan fiable. Un principio de diseño clave fue la escalabilidad, permitiendo la creación de una familia de productos con diferentes capacidades de corriente simplemente ajustando el tipo y la cantidad de MOSFETs utilizados.">The board integrates the BQ34z100 gauge IC for accurate fuel gauging, the BQ76952 for battery monitoring, and the BQ77216 for robust battery protection, ensuring safe operation under extreme conditions. Communication with the host system (the drone) is handled via a reliable DroneCan interface. A key design principle was scalability, allowing for the creation of a family of products with varying current capacities by simply adjusting the type and quantity of MOSFETs used.</p>
                    <h3 data-en="Technical Highlights:" data-es="Aspectos Técnicos Destacados:">Aspectos Técnicos Destacados:</h3>
                    <ul>
                        <li data-en="Supports 14-16s cell configurations." data-es="Soporta configuraciones de celdas 14-16s.">Soporta configuraciones de celdas 14-16s.</li>
                        <li data-en="150A continuous current capability (no heatsink)." data-es="Capacidad de corriente continua de 150A (sin disipador).">Capacidad de corriente continua de 150A (sin disipador).</li>
                        <li data-en="6-layer PCB with 2 Oz copper." data-es="PCB de 6 capas con cobre de 2 Oz.">PCB de 6 capas con cobre de 2 Oz.</li>
                        <li data-en="Integrated BQ34z100, BQ76952, BQ77216 ICs." data-es="CIs integrados BQ34z100, BQ76952, BQ77216.">CIs integrados BQ34z100, BQ76952, BQ77216.</li>
                         <li data-en="DroneCan communication interface." data-es="Interfaz de comunicación DroneCan.">Interfaz de comunicación DroneCan.</li>
                    </ul>
                     </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p><span data-en="&copy; 2025 Nelson Fortunatti. All rights reserved." data-es="&copy; 2025 Nelson Fortunatti. Todos los derechos reservados.">&copy; 2025 Nelson Fortunatti. Todos los derechos reservados.</span></p>
            <p><span data-en="nelsonfortunatti@gmail.com" data-es="nelsonfortunatti@gmail.com">nelsonfortunatti@gmail.com</span></p>
        </div>
    </footer>

    <div id="imageModal" class="modal">
        <span class="close-modal">&times;</span>
        <a class="prev-modal">&#10094;</a>
        <img class="modal-content" id="modalImage">
        <a class="next-modal">&#10095;</a>
        <div id="caption"></div>
    </div>
    <script>
         document.addEventListener('DOMContentLoaded', () => {
            // --- Hamburger Navigation Toggle ---
            const navToggle = document.querySelector('.nav-toggle');
            const primaryNav = document.getElementById('primary-navigation');

            if (navToggle && primaryNav) {
                navToggle.addEventListener('click', () => {
                    primaryNav.classList.toggle('nav-ul-active');
                    navToggle.classList.toggle('is-active');

                    // ARIA attribute for accessibility
                    const isExpanded = primaryNav.classList.contains('nav-ul-active');
                    navToggle.setAttribute('aria-expanded', isExpanded);
                });

                // Optional: Close menu when a navigation link is clicked (useful for single-page anchors)
                const navLinks = primaryNav.querySelectorAll('a');
                navLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        // Check if the menu is open (especially relevant for mobile)
                        if (window.innerWidth <= 768 && primaryNav.classList.contains('nav-ul-active')) {
                            primaryNav.classList.remove('nav-ul-active');
                            navToggle.classList.remove('is-active');
                            navToggle.setAttribute('aria-expanded', 'false');
                        }
                    });
                });
            }

            // --- Language Switcher Script ---
            const htmlTag = document.documentElement;
            const langSwitcherListItem = document.getElementById('lang-switcher'); // Get the LI
            let langSwitcherLink = null;
            if (langSwitcherListItem) {
                langSwitcherLink = langSwitcherListItem.querySelector('a'); // Get the A inside LI
            }
            const elementsToTranslate = document.querySelectorAll('[data-en], [data-es], [data-en-placeholder], [data-es-placeholder]');
            const titleTag = document.querySelector('title');

            function setLanguage(lang) {
                htmlTag.lang = lang;
                localStorage.setItem('lang', lang);

                if (langSwitcherLink) { // Check if link exists
                    if (lang === 'es') {
                        langSwitcherLink.textContent = 'English';
                    } else {
                        langSwitcherLink.textContent = 'Español';
                    }
                }

                if (titleTag) { // Check if titleTag exists
                    const titleEn = titleTag.getAttribute('data-en');
                    const titleEs = titleTag.getAttribute('data-es');
                    if (lang === 'en' && titleEn) {
                        titleTag.textContent = titleEn;
                    } else if (lang === 'es' && titleEs) {
                        titleTag.textContent = titleEs;
                    }
                }


                elementsToTranslate.forEach(element => {
                    const textEn = element.getAttribute('data-en');
                    const textEs = element.getAttribute('data-es');
                    if (lang === 'en' && textEn !== null) {
                        element.textContent = textEn;
                    } else if (lang === 'es' && textEs !== null) {
                        element.textContent = textEs;
                    }

                    const placeholderEn = element.getAttribute('data-en-placeholder');
                    const placeholderEs = element.getAttribute('data-es-placeholder');
                    if (lang === 'en' && placeholderEn !== null) {
                        element.placeholder = placeholderEn;
                    } else if (lang === 'es' && placeholderEs !== null) {
                        element.placeholder = placeholderEs;
                    }
                });
            }

            const savedLang = localStorage.getItem('lang');
            if (savedLang) {
                setLanguage(savedLang);
            } else {
                setLanguage(htmlTag.lang || 'es'); // Default to 'es' if not set, or to HTML lang attr
            }

            if (langSwitcherLink) { // Check if link exists
                langSwitcherLink.addEventListener('click', (event) => {
                    event.preventDefault();
                    const currentLang = htmlTag.lang;
                    const newLang = currentLang === 'es' ? 'en' : 'es';
                    setLanguage(newLang);
                });
            }

            // --- Carousel Script (Only runs if carousel elements are present) ---
            const carouselSlidesContainer = document.querySelector('.carousel-slides');
            if (carouselSlidesContainer) {
                const slides = document.querySelectorAll('.carousel-slide');
                const intervalTime = 3000;
                let slideInterval;
                let currentIndex = 0;

                if (slides.length > 0) {
                    function moveCarouselTo(index) {
                        currentIndex = index;
                        const offset = -currentIndex * 100;
                        carouselSlidesContainer.style.transform = `translateX(${offset}%)`;
                    }

                    function nextSlide() {
                        currentIndex++;
                        if (currentIndex >= slides.length) {
                            currentIndex = 0;
                        }
                        moveCarouselTo(currentIndex);
                    }

                    slideInterval = setInterval(nextSlide, intervalTime);

                    const carouselContainer = carouselSlidesContainer.parentElement;
                    if (carouselContainer) {
                        carouselContainer.addEventListener('mouseenter', () => {
                            clearInterval(slideInterval);
                        });

                        carouselContainer.addEventListener('mouseleave', () => {
                            slideInterval = setInterval(nextSlide, intervalTime);
                        });
                    }
                    moveCarouselTo(0); // Initialize carousel position
                }
            }

            // --- Image Modal Script (Only runs if modal elements are present) ---
            const modal = document.getElementById("imageModal");
            if (modal) {
                modal.style.display = "none"; // Ensure it's hidden initially
                const modalImg = document.getElementById("modalImage");
                const prevModalButton = document.querySelector(".prev-modal");
                const nextModalButton = document.querySelector(".next-modal");
                // const captionText = document.getElementById("caption"); // Uncomment if you implement captions

                let currentModalImageIndex = 0;
                let carouselImageSources = [];

                // Collect image sources from carousel slides if they exist
                const allCarouselSlidesForModal = document.querySelectorAll('.carousel-slide');
                allCarouselSlidesForModal.forEach(slide => {
                    let style = window.getComputedStyle(slide);
                    let bgImage = style.getPropertyValue('background-image');
                    if (bgImage && bgImage !== 'none') {
                        const urlMatch = bgImage.match(/url\(["']?(.*?)["']?\)/);
                        if (urlMatch && urlMatch[1]) {
                            carouselImageSources.push(urlMatch[1]);
                        }
                    }
                });

                function showImageInModal(index) {
                    if (carouselImageSources.length === 0 || !modalImg) return;

                    currentModalImageIndex = index;
                    // Loop around if index goes out of bounds
                    if (currentModalImageIndex < 0) {
                        currentModalImageIndex = carouselImageSources.length - 1;
                    } else if (currentModalImageIndex >= carouselImageSources.length) {
                        currentModalImageIndex = 0;
                    }
                    modalImg.src = carouselImageSources[currentModalImageIndex];
                    // if (captionText) { captionText.innerHTML = allCarouselSlidesForModal[currentModalImageIndex].getAttribute('data-caption') || ''; }
                }

                allCarouselSlidesForModal.forEach((slide, index) => {
                    slide.onclick = function(){
                        if (modalImg && carouselImageSources.length > 0) {
                            modal.style.display = "flex"; // Use flex for centering
                            showImageInModal(index);
                        }
                    }
                });

                if (prevModalButton) {
                    prevModalButton.onclick = function() { showImageInModal(currentModalImageIndex - 1); }
                }
                if (nextModalButton) {
                    nextModalButton.onclick = function() { showImageInModal(currentModalImageIndex + 1); }
                }

                const closeModalButton = document.querySelector(".close-modal");
                if (closeModalButton) {
                    closeModalButton.onclick = function() { modal.style.display = "none"; }
                }

                window.onclick = function(event) {
                    if (event.target == modal) { modal.style.display = "none"; }
                }

                document.addEventListener('keydown', function(event) {
                    if (modal.style.display === "flex") { // Check if modal is active
                        if (event.key === "ArrowLeft" && prevModalButton) prevModalButton.click();
                        else if (event.key === "ArrowRight" && nextModalButton) nextModalButton.click();
                        else if (event.key === "Escape" && closeModalButton) closeModalButton.click();
                    }
                });
            }
        });
     </script>

</body>
</html>           event.preventDefault();
                 const currentLang = htmlTag.lang;
                 const newLang = currentLang === 'es' ? 'en' : 'es';
                 setLanguage(newLang);
             });

             // --- Carousel Script ---
             const carouselSlidesContainer = document.querySelector('.carousel-slides');
             const slides = document.querySelectorAll('.carousel-slide'); // Re-select for this script's scope
             const intervalTime = 2000; // 2 seconds
             let slideInterval;
             let currentIndex = 0;

             if (carouselSlidesContainer && slides.length > 0) { // Check if elements exist
                 function moveCarouselTo(index) {
                      currentIndex = index;
                      const offset = -currentIndex * 100;
                      carouselSlidesContainer.style.transform = `translateX(${offset}%)`;
                 }

                 function nextSlide() {
                     currentIndex++;
                     if (currentIndex >= slides.length) {
                          currentIndex = 0;
                     }
                     moveCarouselTo(currentIndex);
                 }

                 slideInterval = setInterval(nextSlide, intervalTime);

                 carouselSlidesContainer.parentElement.addEventListener('mouseenter', () => {
                      clearInterval(slideInterval);
                 });

                 carouselSlidesContainer.parentElement.addEventListener('mouseleave', () => {
                      slideInterval = setInterval(nextSlide, intervalTime);
                 });

                  moveCarouselTo(0); // Initialize carousel position
             } else if (slides.length > 0) { // Only slides exist, not container (should not happen with current HTML)
                 console.warn("Carousel slides found, but container .carousel-slides is missing.");
             } else {
                 console.warn("No slides found for the carousel.");
             }

             // --- Image Modal Script ---
            const modal = document.getElementById("imageModal");
            if (modal) {
                modal.style.display = "none";
            }
            const modalImg = document.getElementById("modalImage");
            // Uncommented and selected the new modal buttons
            const prevModalButton = document.querySelector(".prev-modal");
            const nextModalButton = document.querySelector(".next-modal");
            // const captionText = document.getElementById("caption"); // Uncomment if using captions

            let currentModalImageIndex = 0;
            let carouselImageSources = [];

            // Collect all carousel image sources on page load
            // This assumes all .carousel-slide elements are for the main carousel on the page
            const allCarouselSlides = document.querySelectorAll('.carousel-slide');
            allCarouselSlides.forEach(slide => {
                let style = window.getComputedStyle(slide);
                let bgImage = style.getPropertyValue('background-image');
                if (bgImage && bgImage !== 'none') {
                    // Extract URL from background-image style
                    const urlMatch = bgImage.match(/url\(["']?(.*?)["']?\)/);
                    if (urlMatch && urlMatch[1]) {
                        carouselImageSources.push(urlMatch[1]);
                    }
                }
            });

            function showImageInModal(index) {
                if (carouselImageSources.length === 0 || !modalImg) return;
                currentModalImageIndex = index;
                modalImg.src = carouselImageSources[currentModalImageIndex];
                // Example for caption:
                // const currentSlideElement = allCarouselSlides[currentModalImageIndex];
                // if (captionText && currentSlideElement) {
                //     captionText.innerHTML = currentSlideElement.getAttribute('data-caption') || '';
                // }
            }

            allCarouselSlides.forEach((slide, index) => {
                slide.onclick = function(){
                    if (modal && modalImg && carouselImageSources.length > 0) {
                        modal.style.display = "block";
                        showImageInModal(index);
                    }
                }
            });

            // Added click handlers for the new modal buttons
            if (prevModalButton) {
                prevModalButton.onclick = function() {
                    currentModalImageIndex--;
                    if (currentModalImageIndex < 0) {
                        currentModalImageIndex = carouselImageSources.length - 1;
                    }
                    showImageInModal(currentModalImageIndex);
                }
            }

            if (nextModalButton) {
                nextModalButton.onclick = function() {
                    currentModalImageIndex++;
                    if (currentModalImageIndex >= carouselImageSources.length) {
                        currentModalImageIndex = 0;
                    }
                    showImageInModal(currentModalImageIndex);
                }
            }

            const closeModalButton = document.querySelector(".close-modal");
            if (closeModalButton && modal) {
                closeModalButton.onclick = function() {
                    modal.style.display = "none";
                }
            }

            window.onclick = function(event) {
                if (event.target == modal && modal) {
                    modal.style.display = "none";
                }
            }

            // Optional: Add keyboard navigation for arrows when modal is open
            document.addEventListener('keydown', function(event) {
                if (modal && modal.style.display === "block") {
                    if (event.key === "ArrowLeft") {
                        if (prevModalButton) prevModalButton.click();
                    } else if (event.key === "ArrowRight") {
                        if (nextModalButton) nextModalButton.click();
                    } else if (event.key === "Escape") {
                        if (closeModalButton) closeModalButton.click();
                    }
                }
            });
        });
     </script>

</body>
</html>